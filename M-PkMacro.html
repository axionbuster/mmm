<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>M.PkMacro</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">mmm-0.1.0.0: Minecraft 1.21.4 implementation in Haskell</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/M.PkMacro.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) axionbuster 2025</td></tr><tr><th>License</th><td>BSD-3-Clause</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>GHC2021</td></tr></table><p class="caption">M.PkMacro</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides Template Haskell functionality to generate data types with
 automatic <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>/<code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code> instances. It uses a simple grammar to define data types
 and their field mappings.</p><h2>Usage</h2><p>Define data types using the <code><a href="M-PkMacro.html#v:pkmacro" title="M.PkMacro">pkmacro</a></code> quasi-quoter. The syntax is indentation-insensitive:</p><pre>-- First, set up default instances
<code><a href="M-PkMacro.html#v:setdefaultderives" title="M.PkMacro">setdefaultderives</a></code>  -- Sets up <code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code>, <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>, and <code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code> derives

-- Define a newtype wrapper with <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>/<code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code> instances
newtype AAA = AAA <code><a href="../base-4.20.0.0/Data-Int.html#v:Int32" title="Data.Int">Int32</a></code>
  deriving stock (<code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code>)
  deriving newtype (<code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>, <code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code>)

[pkmacro|
-- Regular data type with two fields
data A {
  f1 :: Int32,                -- Regular field
  f2 :: Int32 via AAA,       -- Field with custom serialization
}

-- Data type with one field and explicit deriving
data B {
  f3 :: Int32,
  deriving (<code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code>, <code><a href="../base-4.20.0.0/Prelude.html#t:Show" title="Prelude">Show</a></code>)
}

-- Empty data type (creates constructor with no fields)
data C {}
|]
</pre><p>The grammar supports:</p><ul><li>Empty data types (no fields)</li><li>Custom serialization via <code>via</code> clause</li><li>Multiple data types in one block</li><li>Indentation-insensitive syntax</li><li>Comments (both <code>--</code> and <code>{- -}</code> style)</li></ul><h2>Syntax</h2><p>The full syntax for data type definitions is:</p><pre>data TypeName {
  field1 :: Type1 [via Type2],     -- Field with optional via clause
  field2 :: Type3,                 -- Regular field
  [deriving (Class1, Class2)]      -- Optional proper deriving clause
  [and shadow deriving (<code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>, <code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code>) with (Class3, Class4)] -- Optional shadow deriving
}
</pre><p>Elements in square brackets are optional.</p><ul><li>The <code>via</code> clause specifies a different type to use for serialization</li><li><code>deriving</code> adds instances to the main data type</li><li><code>shadow deriving</code> adds instances to the generated shadow type used for serialization</li><li>Multiple data types can be defined in a single quasi-quoter block</li></ul><h3>Type Syntax</h3><p>Types can include:</p><ul><li>Simple types: <code><code><a href="../base-4.20.0.0/Data-Int.html#v:Int32" title="Data.Int">Int32</a></code></code>, <code><code><a href="../text-2.1.1/Data-Text.html#v:Text" title="Data.Text">Text</a></code></code>, etc.</li><li>Parameterized types: <code><code><a href="../base-4.20.0.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a></code> a</code>, <code>[<code><a href="../base-4.20.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></code>]</code></li><li>Type applications: <code>a @k</code></li><li>Promoted types: <code>'True</code>, <code>'Just</code></li><li>Type literals: <code>&quot;hello&quot;</code>, <code>123</code></li><li>Parenthesized types: <code>(a, b)</code>, <code>(<code><a href="../base-4.20.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a></code> a b)</code></li></ul><p>See: <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code>, <code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code>, <code><a href="M-PkMacro.html#v:setdefaultderives" title="M.PkMacro">setdefaultderives</a></code>, <code><a href="M-PkMacro.html#v:addproperderives" title="M.PkMacro">addproperderives</a></code>, and <code><a href="M-PkMacro.html#v:addshadowderives" title="M.PkMacro">addshadowderives</a></code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:setdefaultderives">setdefaultderives</a> :: <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:addproperderives">addproperderives</a> :: [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>] -&gt; <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:addshadowderives">addshadowderives</a> :: [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>] -&gt; <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:pkmacro">pkmacro</a> :: <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:setdefaultderives" class="def">setdefaultderives</a> :: <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/M.PkMacro.html#setdefaultderives" class="link">Source</a> <a href="#v:setdefaultderives" class="selflink">#</a></p><div class="doc"><p>Set up default derives for subsequent data types.
 This sets <code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code> for proper derives and <code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code> + <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code> + <code><a href="M-Pack-Internal-Types.html#t:Unpack" title="M.Pack.Internal.Types">Unpack</a></code> for shadow derives.</p><p>Use this at the start of your module to automatically derive the most common instances.</p></div></div><div class="top"><p class="src"><a id="v:addproperderives" class="def">addproperderives</a> :: [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>] -&gt; <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/M.PkMacro.html#addproperderives" class="link">Source</a> <a href="#v:addproperderives" class="selflink">#</a></p><div class="doc"><p>Add proper deriving clauses for subsequent data types.
 These instances will be derived directly on the main data type.</p><pre><code><a href="M-PkMacro.html#v:addproperderives" title="M.PkMacro">addproperderives</a></code> [''Generic, ''Show]  -- Derive Generic and Show
</pre></div></div><div class="top"><p class="src"><a id="v:addshadowderives" class="def">addshadowderives</a> :: [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>] -&gt; <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/M.PkMacro.html#addshadowderives" class="link">Source</a> <a href="#v:addshadowderives" class="selflink">#</a></p><div class="doc"><p>Add shadow deriving clauses for subsequent data types.
 These instances will be derived on the shadow data type used for serialization.</p><pre><code><a href="M-PkMacro.html#v:addshadowderives" title="M.PkMacro">addshadowderives</a></code> [''Generic, ''Pack]  -- Derive <code><a href="../base-4.20.0.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a></code> and <code><a href="M-Pack-Internal-Types.html#t:Pack" title="M.Pack.Internal.Types">Pack</a></code> on shadow type
</pre></div></div><div class="top"><p class="src"><a id="v:pkmacro" class="def">pkmacro</a> :: <a href="../template-haskell-2.22.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a> <a href="src/M.PkMacro.html#pkmacro" class="link">Source</a> <a href="#v:pkmacro" class="selflink">#</a></p><div class="doc"><p>See module docs (<a href="M-PkMacro.html">M.PkMacro</a>) for information.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.28.0</p></div></body></html>